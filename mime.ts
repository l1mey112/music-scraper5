export function mime_ext(mime: string | null | undefined) {
	if (!mime) {
		return '.bin'
	}

	// trim ;
	const semicolon = mime.indexOf(';')
	if (semicolon !== -1) {
		mime = mime.substring(0, semicolon)
	}

	return mime_ext_table[mime] ?? '.bin'
}

// TODO: only need a small subset of these, this is way too much
const mime_ext_table: Record<string, string> = Object.freeze({
	'application/x-7z-compressed': '.7z',
	'application/x-authorware-bin': '.aab',
	'application/x-authorware-map': '.aam',
	'application/x-authorware-seg': '.aas',
	'text/vnd.abc': '.abc',
	'text/html': '.acgi',
	'video/animaflex': '.afl',
	'application/postscript': '.ai',
	'audio/aiff': '.aiff',
	'audio/x-aiff': '.aiff',
	'application/x-aim': '.aim',
	'text/x-audiosoft-intra': '.aip',
	'application/x-navi-animation': '.ani',
	'application/x-nokia-9000-communicator-add-on-software': '.aos',
	'application/mime': '.aps',
	'application/octet-stream': '.bin',
	'application/arj': '.arj',
	'image/x-jg': '.art',
	'video/x-ms-asf': '.asf',
	'text/x-asm': '.asm',
	'text/asp': '.asp',
	'application/x-mplayer2': '.asx',
	'audio/basic': '.au',
	'audio/x-au': '.au',
	'application/x-troff-msvideo': '.avi',
	'video/avi': '.avi',
	'video/msvideo': '.avi',
	'video/x-msvideo': '.avi',
	'video/avs-video': '.avs',
	'application/x-bcpio': '.bcpio',
	'application/mac-binary': '.bin',
	'application/macbinary': '.bin',
	'application/x-binary': '.bin',
	'application/x-macbinary': '.bin',
	'image/bmp': '.bmp',
	'image/x-windows-bmp': '.bmp',
	'application/book': '.boo',
	'application/x-bzip2': '.boz',
	'application/x-bsh': '.bsh',
	'application/x-bzip': '.bz',
	'application/vnd.ms-pki.seccat': '.cat',
	'application/clariscad': '.ccad',
	'text/plain': '.txt',
	'video/x-dv': '.dif',
	'application/x-director': '.dir',
	'video/dl': '.dl',
	'video/x-dl': '.dl',
	'application/msword': '.doc',
	'application/vnd.openxmlformats-officedocument.wordprocessingml.document': '.docx',
	'application/commonground': '.dp',
	'application/drafting': '.drw',
	'application/x-dvi': '.dvi',
	'model/vnd.dwf': '.dwf',
	'application/acad': '.dwg',
	'image/vnd.dwg': '.dwg',
	'image/x-dwg': '.dwg',
	'application/dxf': '.dxf',
	'text/x-script.elisp': '.el',
	'application/x-elc': '.elc',
	'application/x-envoy': '.env',
	'application/vnd.ms-fontobject': '.eot',
	'application/x-esrehber': '.es',
	'text/x-setext': '.etx',
	'application/envoy': '.evy',
	'image/fif': '.fif',
	'audio/webm': '.webm',
	'audio/flac': '.flac',
	'video/fli': '.fli',
	'video/x-fli': '.fli',
	'image/florian': '.flo',
	'text/vnd.fmi.flexstor': '.flx',
	'video/x-atomic3d-feature': '.fmf',
	'text/x-fortran': '.for',
	'image/vnd.fpx': '.fpx',
	'image/vnd.net-fpx': '.fpx',
	'application/freeloader': '.frl',
	'audio/make': '.funk',
	'image/g3fax': '.g3',
	'image/gif': '.gif',
	'video/gl': '.gl',
	'video/x-gl': '.gl',
	'audio/x-gsm': '.gsd',
	'application/x-gsp': '.gsp',
	'application/x-gss': '.gss',
	'application/x-gtar': '.gtar',
	'application/x-compressed': '.gz',
	'application/x-gzip': '.gz',
	'image/pjpeg': '.jpg',
	'image/jpeg': '.jpg',
	'application/json': '.json',
	'audio/nspaudio': '.la',
	'audio/x-nspaudio': '.la',
	'audio/x-liveaudio': '.lam',
	'application/x-latex': '.latex',
	'application/lha': '.lha',
	'application/x-lha': '.lha',
	'application/x-lisp': '.lsp',
	'text/x-script.lisp': '.lsp',
	'audio/x-mpequrl': '.m3u',
	'application/x-troff-man': '.man',
	'application/x-navimap': '.map',
	'application/mbedlet': '.mbd',
	'application/x-magic-cap-package-1.0': '.mc$',
	'application/mcad': '.mcd',
	'application/x-mathcad': '.mcd',
	'audio/x-vnd.audioexplosion.mjuicemediafile': '.mjf',
	'video/x-motion-jpeg': '.mjpg',
	'audio/x-matroska': '.mka',
	'video/x-matroska': '.mkv',
	'video/quicktime': '.mov',
	'audio/mpeg3': '.mp3',
	'audio/x-mpeg-3': '.mp3',
	'video/x-mpeg': '.mp3',
	'video/mp4': '.mp4',
	'audio/mpeg': '.mpa',
	'application/x-project': '.mpc',
	'application/oda': '.oda',
	'audio/ogg': '.ogg',
	'video/ogg': '.ogg',
	'application/x-omc': '.omc',
	'application/x-omcdatamaker': '.omcd',
	'application/x-omcregerator': '.omcr',
	'font/otf': '.otf',
	'text/x-pascal': '.p',
	'image/svg+xml': '.svg',
	'image/apng': '.apng',
	'image/png': '.png',
	'audio/vnd.qcelp': '.qcp',
	'x-world/x-3dmf': '.qd3',
	'image/x-quicktime': '.qif',
	'video/x-qtc': '.qtc',
	'audio/x-pn-realaudio': '.ra',
	'audio/x-pn-realaudio-plugin': '.ra',
	'audio/x-realaudio': '.ra',
	'application/x-cmu-raster': '.ras',
	'image/cmu-raster': '.ras',
	'image/x-cmu-raster': '.ras',
	'application/vnd.rar': '.rar',
	'text/x-script.rexx': '.rexx',
	'image/vnd.rn-realflash': '.rf',
	'image/x-rgb': '.rgb',
	'application/vnd.rn-realmedia': '.rm',
	'audio/mid': '.rmi',
	'application/ringing-tones': '.rng',
	'application/vnd.nokia.ringing-tone': '.rng',
	'application/vnd.rn-realplayer': '.rnx',
	'application/x-troff': '.roff',
	'image/vnd.rn-realpix': '.rp',
	'text/richtext': '.rt',
	'text/vnd.rn-realtext': '.rt',
	'application/rtf': '.rtf',
	'application/x-rtf': '.rtf',
	'application/x-tbook': '.sbk',
	'application/x-lotusscreencam': '.scm',
	'image/tiff': '.tiff',
	'image/x-tiff': '.tiff',
	'audio/wav': '.wav',
	'audio/x-wav': '.wav',
	'video/webm': '.webm',
	'image/webp': '.webp',
	'image/x-xbitmap': '.xbm',
	'image/x-xbm': '.xbm',
	'image/xbm': '.xbm',
	'xgl/drawing': '.xgz',
	'image/vnd.xiff': '.xif',
})
